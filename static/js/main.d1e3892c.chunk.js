(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{123:function(e,t,n){},151:function(e,t,n){},231:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(28),a=n.n(r),i=(n(151),n(123),n(152),n(30)),u=n(88),s=n(25),o=n(45),j=n(237),l=n(239),d=n(38),h=n(65),b=n(235),O=n(234),p=n(238),f=n(240),m=n(50),v=n.n(m),g=n(82),x=n(112),y=n(120);n(161);y.a.initializeApp({apiKey:"AIzaSyAA1dqkwwQA2mYN0BqW73Ut7woZ-BJjXqs",authDomain:"mini-paint-aeaa1.firebaseapp.com",projectId:"mini-paint-aeaa1",storageBucket:"mini-paint-aeaa1.appspot.com",messagingSenderId:"224116247597",appId:"1:224116247597:web:7c378b98c6ed5cfd397ca4"});var w=y.a.firestore(),k="DATA/GET_DATA",A="DATA/ADD_DATA",S="DATA/DELETE_DATA",I="USER/GOOGLE_SIGN_IN",E="USER/LOGOUT",T="DATA/CLEAR_DATA",C=n(145),D=function(e,t){C.a.error({message:e,description:t,placement:"bottomLeft"})},M=function(){return function(){var e=Object(g.a)(v.a.mark((function e(t){var n,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w.collection("images").orderBy("id"),c=[],e.prev=2,e.next=5,n.get().then((function(e){e.forEach((function(e){c=[Object(d.a)(Object(d.a)({},e.data()),{},{firestoreId:e.id})].concat(Object(h.a)(c))}))})).then((function(){t({type:k,payload:c})})).catch((function(e){throw e}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),D(e.t0.name,e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},R=n(10),_=function(e){var t=Object(i.b)(),n=Object(i.c)((function(e){return e.user.user}));return Object(R.jsx)(O.a,{cover:Object(R.jsx)("img",{src:e.base64}),actions:[n.uid===e.uid?Object(R.jsx)(f.a,{onClick:function(){return t((n=e,function(){var e=Object(g.a)(v.a.mark((function e(t){var c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=w.collection("images"),e.prev=1,e.next=4,c.doc(n.firestoreId).delete().then((function(){console.log("success","Image deleted!")})).then((function(){t({type:S,payload:[n]})})).catch((function(e){throw e}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),D(e.t0.name,e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));var n}},e.id):null],children:Object(R.jsx)(O.a.Meta,{avatar:Object(R.jsx)(p.a,{src:e.avatar}),title:e.username})},e.id)},N=function(){var e=Object(i.c)((function(e){return e.images.images})),t=Object(i.c)((function(e){return e.user.user})),n=Object(i.b)(),r=Object(c.useState)("All"),a=Object(o.a)(r,2),u=a[0],s=a[1];Object(c.useEffect)((function(){n(M())}),[n]);var j=e.reduce((function(e,n){return e.find((function(e){return e===n.username||"My"===e&&n.uid===t.uid}))?e:[].concat(Object(h.a)(e),[t.uid===n.uid?"My":n.username])}),["All"]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{children:[Object(R.jsx)("span",{children:"Sort by user "}),Object(R.jsx)(b.a,{className:"users-select",value:u,onChange:function(e){return s("".concat(e))},children:j.map((function(e,t){return Object(R.jsx)(b.a.Option,{value:e,children:e},t)}))})]}),Object(R.jsxs)("div",{className:"images-wrapper",children:[Object(R.jsx)("h3",{children:"".concat(u," images")}),e.map((function(e){return e.username===u||"All"===u||"My"===u&&e.uid===t.uid?Object(c.createElement)(_,Object(d.a)(Object(d.a)({},e),{},{key:e.id})):null}))]})]})},L=n(236),P=["Pencil","Rectangle","Circle","Line"],U=function(){var e=Object(c.useRef)(null),t=Object(c.useRef)(null),n=Object(c.useRef)(null),r=Object(c.useRef)(null),a=Object(c.useState)(!1),u=Object(o.a)(a,2),s=u[0],j=u[1],h=Object(c.useState)(0),O=Object(o.a)(h,2),p=O[0],f=O[1],m=Object(c.useState)(0),x=Object(o.a)(m,2),y=x[0],k=x[1],S=Object(c.useState)(P[0]),I=Object(o.a)(S,2),E=I[0],T=I[1],C=Object(c.useState)(5),_=Object(o.a)(C,2),N=_[0],U=_[1],B=Object(c.useState)("#776e6e"),G=Object(o.a)(B,2),W=G[0],J=G[1],q=Object(c.useState)(0),F=Object(o.a)(q,2),H=F[0],z=F[1],X=Object(i.c)((function(e){return e.user.user})),K=Object(i.b)();Object(c.useEffect)((function(){var c=e.current;c.width=.8*parent.innerWidth,c.height=.8*parent.innerHeight;var a=c.getContext("2d");t.current=a,a.lineCap="round";var i=n.current;i.width=.8*parent.innerWidth,i.height=.8*parent.innerHeight;var u=i.getContext("2d");r.current=u,z(document.getElementById("tools").clientHeight+document.getElementById("page-header").clientHeight+14)}),[]);var Q=function(){return(window.innerWidth-e.current.width)/2};return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{id:"tools",children:[Object(R.jsx)(l.a,{onClick:function(){r.current.clearRect(0,0,e.current.width,e.current.height),t.current.clearRect(0,0,e.current.width,e.current.height)},children:"clear"}),Object(R.jsx)(l.a,{onClick:function(){var e,t,c,r;K((e=n.current.toDataURL(),t=X.uid,c=X.displayName,r=X.photoURL,function(){var n=Object(g.a)(v.a.mark((function n(a){var i,u;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=w.collection("images"),u={base64:e,id:"".concat((new Date).getTime()),uid:t,username:c,avatar:r},n.prev=2,n.next=5,i.add(u).then((function(){a({type:A,payload:Object(d.a)({},u)})})).catch((function(e){throw e}));case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),D(n.t0.name,n.t0.message);case 10:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e){return n.apply(this,arguments)}}())),K(M())},children:"save"}),Object(R.jsx)(b.a,{value:E,onChange:function(e){return T("".concat(e))},children:P.map((function(e,t){return Object(R.jsx)(b.a.Option,{value:e,children:e},"".concat(t))}))}),Object(R.jsx)("input",{type:"color",id:"color",value:W,onChange:function(e){return J(e.target.value)}}),Object(R.jsx)(L.a,{value:N,onChange:function(e){return U(+e)}})]}),Object(R.jsxs)("div",{id:"viewport",children:[Object(R.jsx)("canvas",{id:"canvas",onMouseUp:function(){t.current.closePath(),r.current.drawImage(e.current,0,0),t.current.clearRect(0,0,e.current.width,e.current.height),j(!1)},onMouseDown:function(e){var n=e.nativeEvent,c=n.x,r=n.y;t.current.beginPath(),t.current.moveTo(c-Q(),r-H),j(!0),f(c),k(r)},onMouseMove:function(n){var c=n.nativeEvent;if(s){var r=c.x,a=c.y;switch(t.current.lineWidth=N,t.current.strokeStyle=W,t.current.clearRect(0,0,e.current.width,e.current.height),E){case"Line":t.current.beginPath(),t.current.moveTo(p-Q(),y-H),t.current.lineTo(r-Q(),a-H);break;case"Circle":t.current.beginPath(),t.current.arc(p-Q(),y-H,Math.sqrt(Math.pow(a-y,2)+Math.pow(r-p,2)),0,2*Math.PI,!0);break;case"Pencil":t.current.lineTo(r-Q(),a-H);break;case"Rectangle":var i=Math.min(r,p)-Q(),u=Math.min(a,y)-H,o=Math.abs(r-p),j=Math.abs(a-y);t.current.strokeRect(i,u,o,j)}t.current.stroke()}},ref:e}),Object(R.jsx)("canvas",{id:"temp_canvas",ref:n})]})]})},B=function(){var e=Object(s.g)().path,t=Object(i.b)(),n=Object(c.useState)("feed"),r=Object(o.a)(n,2),a=r[0],d=r[1];return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(j.a,{mode:"horizontal",id:"page-header",selectedKeys:[a],onClick:function(e){return d(e.key)},children:[Object(R.jsx)(j.a.Item,{children:Object(R.jsx)(u.b,{to:"".concat(e,"/paint"),children:"Paint"})},"paint"),Object(R.jsx)(j.a.Item,{children:Object(R.jsx)(u.b,{to:e,children:"Feed"})},"feed"),Object(R.jsx)(j.a.Item,{children:Object(R.jsx)(l.a,{id:"logout-button",onClick:function(){t(function(){var e=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.auth().signOut().then((function(){t({type:E,payload:{}})})).catch((function(e){throw e}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),D(e.t0.name,e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()),t({type:T,payload:[]})},children:"Logout"})},"logout-button")]}),Object(R.jsx)(s.b,{exact:!0,path:e,component:N}),Object(R.jsx)(s.b,{path:"".concat(e,"/paint"),component:U})]})},G=function(){var e=Object(i.b)();return Object(R.jsx)("div",{className:"auth-wrapper",children:Object(R.jsxs)("div",{className:"auth-container",children:[Object(R.jsx)("h1",{children:"Sign In with Google"}),Object(R.jsx)(l.a,{onClick:function(){return e(function(){var e=Object(g.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new x.a.auth.GoogleAuthProvider,e.next=3,x.a.auth().signInWithPopup(n).then((function(e){var n=e.user;t({type:I,payload:n})})).catch((function(e){D(e.name,e.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Auth"})]})})},W="/app",J="/auth",q="/",F=function(){var e=Object(i.c)((function(e){return e.user.user.uid}));return Object(R.jsx)(u.a,{children:Object(R.jsxs)(s.d,{children:[Object(R.jsx)(s.b,{exact:!0,path:q,children:Object(R.jsx)(s.a,{to:e?W:J})}),Object(R.jsx)(s.b,{path:W,render:function(){return e?Object(R.jsx)(B,{}):Object(R.jsx)(s.a,{to:J})}}),Object(R.jsx)(s.b,{path:J,render:function(){return e?Object(R.jsx)(s.a,{to:W}):Object(R.jsx)(G,{})}})]})})};var H=function(){return Object(R.jsx)(F,{})},z=n(81),X={images:[]},K={user:{}},Q=Object(z.b)({images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return{images:t.payload};case A:return Object(d.a)({},e);case S:return Object(d.a)(Object(d.a)({},e),{},{images:[].concat(Object(h.a)(e.images.slice(0,e.images.findIndex((function(e){return e.id===t.payload[0].id})))),Object(h.a)(e.images.slice(e.images.findIndex((function(e){return e.id===t.payload[0].id}))+1)))});case T:return{images:t.payload};default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(d.a)(Object(d.a)({},e),{},{user:t.payload});case E:return{user:t.payload};default:return e}}}),V=n(142),Y=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),Z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||z.c,$=Object(z.d)(Q,Y,Z(Object(z.a)(V.a)));$.subscribe((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){console.log(n)}}({user:$.getState().user})}));var ee=Object(R.jsxs)(i.a,{store:$,children:["fghifdhhgkfhjkfhkhkh",Object(R.jsx)(H,{})]});a.a.render(ee,document.getElementById("root"))}},[[231,1,2]]]);
//# sourceMappingURL=main.d1e3892c.chunk.js.map