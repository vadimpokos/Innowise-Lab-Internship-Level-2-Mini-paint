(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{223:function(e,t,n){},224:function(e,t,n){},231:function(e,t,n){},232:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(28),i=n.n(a),o=(n(150),n(30)),u=n(88),s=n(25),l=n(33),d=n(65),j=n(45),b=n(236),h=n(235),f=n(239),p=n(241),O=n(46),v=n.n(O),m=n(67),g=n(119);n(154);g.a.initializeApp({apiKey:"AIzaSyAA1dqkwwQA2mYN0BqW73Ut7woZ-BJjXqs",authDomain:"mini-paint-aeaa1.firebaseapp.com",projectId:"mini-paint-aeaa1",storageBucket:"mini-paint-aeaa1.appspot.com",messagingSenderId:"224116247597",appId:"1:224116247597:web:7c378b98c6ed5cfd397ca4"});var x=g.a.firestore(),w=n(144),y=function(e){var t=e.message,n=e.description,r=e.placement,c=void 0===r?"bottomLeft":r;w.a.error({message:t,description:n,placement:c})},k="DATA/GET_DATA",E="DATA/ADD_DATA",R="DATA/DELETE_DATA",A="USER/GOOGLE_SIGN_IN",I="USER/LOGOUT",S="DATA/CLEAR_DATA",C=function(){return function(){var e=Object(m.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.collection("images").orderBy("id"),r=[],e.prev=2,e.next=5,n.get().then((function(e){e.forEach((function(e){r=[Object(l.a)(Object(l.a)({},e.data()),{},{firestoreId:e.id})].concat(Object(d.a)(r))}))})).then((function(){t({type:k,payload:r})})).catch((function(e){throw e}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),e.t0 instanceof Error?y({message:e.t0.name,description:e.t0.message}):y({message:"error",description:"unknown error"});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},T=n(9),M=function(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.user.user}));return Object(T.jsx)(h.a,{cover:Object(T.jsx)("img",{src:e.base64}),actions:[n.uid===e.uid?Object(T.jsx)(p.a,{onClick:function(){var n;t((n=e,function(){var e=Object(m.a)(v.a.mark((function e(t){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.collection("images"),e.prev=1,e.next=4,r.doc(n.firestoreId).delete().then((function(){t({type:R,payload:[n]})})).catch((function(e){throw e}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),e.t0 instanceof Error?y({message:e.t0.name,description:e.t0.message}):y({message:"error",description:"unknown error"});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()))}},e.id):null],children:Object(T.jsx)(h.a.Meta,{avatar:Object(T.jsx)(f.a,{src:e.avatar}),title:e.username})},e.id)},D=c.a.memo(M),_=(n(223),function(){var e=Object(o.c)((function(e){return e.images.images})),t=Object(o.c)((function(e){return e.user.user})),n=Object(o.b)(),c=Object(r.useState)("All"),a=Object(j.a)(c,2),i=a[0],u=a[1];Object(r.useEffect)((function(){n(C())}),[n]);var s=e.reduce((function(e,n){return e.find((function(e){return e===n.username||"My"===e&&n.uid===t.uid}))?e:[].concat(Object(d.a)(e),[t.uid===n.uid?"My":n.username])}),["All"]);return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("div",{children:[Object(T.jsx)("span",{children:"Sort by user "}),Object(T.jsx)(b.a,{className:"users-select",value:i,onChange:function(e){u("".concat(e))},children:s.map((function(e,t){return Object(T.jsx)(b.a.Option,{value:e,children:e},t)}))})]}),Object(T.jsxs)("div",{className:"images-wrapper",children:[Object(T.jsx)("h3",{children:"".concat(i," images")}),e.map((function(e){return e.username===i||"All"===i||"My"===i&&e.uid===t.uid?Object(r.createElement)(D,Object(l.a)(Object(l.a)({},e),{},{key:e.id})):null}))]})]})}),N=c.a.memo(_),L=n(240),P=n(237),W=["Pencil","Rectangle","Circle","Line"],U=(n(224),function(e){var t=e.canvasRef,n=e.secondCanvasRef,c=e.secondContextRef,a=e.contextRef,i=e.selectedTool,o=e.lineWidth,u=e.color,s=Object(r.useState)(!1),l=Object(j.a)(s,2),d=l[0],b=l[1],h=Object(r.useState)(0),f=Object(j.a)(h,2),p=f[0],O=f[1],v=Object(r.useState)(0),m=Object(j.a)(v,2),g=m[0],x=m[1],w=Object(r.useRef)(null),y=Object(r.useRef)(null),k=Object(r.useRef)(null),E=Object(r.useRef)(null),R=Object(r.useRef)(null);Object(r.useEffect)((function(){var e=w.current;if(e){var r,i;e.width=(null===(r=R.current)||void 0===r?void 0:r.clientWidth)||0,e.height=(null===(i=R.current)||void 0===i?void 0:i.clientHeight)||0;var o=e.getContext("2d");y.current=o,o&&(o.lineCap="round")}t&&(t.current=w.current),a&&(a.current=y.current);var u=E.current;if(u){var s,l;u.width=(null===(s=R.current)||void 0===s?void 0:s.clientWidth)||0,u.height=(null===(l=R.current)||void 0===l?void 0:l.clientHeight)||0;var d=null===u||void 0===u?void 0:u.getContext("2d");k.current=d}n&&(n.current=E.current),c&&(c.current=k.current)}),[t,a,n,c]);var A=function(){var e=w.current?w.current.width:0;return(window.innerWidth-e)/2},I=function(){var e,t;return((document.getElementById("tools")?null===(e=document.getElementById("tools"))||void 0===e?void 0:e.clientHeight:0)||0)+((document.getElementById("page-header")?null===(t=document.getElementById("page-header"))||void 0===t?void 0:t.clientHeight:0)||0)+12};return Object(T.jsxs)("div",{id:"viewport",ref:R,children:[Object(T.jsx)("canvas",{id:"canvas",onMouseUp:function(){var e;null===(e=y.current)||void 0===e||e.closePath(),function(){var e,n;null===(e=k.current)||void 0===e||e.drawImage(w.current?w.current:t.current,0,0),null===(n=y.current)||void 0===n||n.clearRect(0,0,w.current?w.current.width:0,w.current?w.current.height:0)}(),b(!1)},onMouseDown:function(e){var t,n,r=e.nativeEvent,c=r.x,a=r.y;null===(t=y.current)||void 0===t||t.beginPath(),null===(n=y.current)||void 0===n||n.moveTo(c-A(),a-I()),b(!0),O(c),x(a)},onMouseMove:function(e){var t,n,r,c,a,s,l,j,b,h=e.nativeEvent;if(d){var f=h.x,O=h.y;switch(!y.current||(y.current.lineWidth=o),!y.current||(y.current.strokeStyle=u),null===(t=y.current)||void 0===t||t.clearRect(0,0,w.current?w.current.width:0,w.current?w.current.height:0),i){case"Line":null===(n=y.current)||void 0===n||n.beginPath(),null===(r=y.current)||void 0===r||r.moveTo(p-A(),g-I()),null===(c=y.current)||void 0===c||c.lineTo(f-A(),O-I());break;case"Circle":null===(a=y.current)||void 0===a||a.beginPath(),null===(s=y.current)||void 0===s||s.arc(p-A(),g-I(),Math.sqrt(Math.pow(O-g,2)+Math.pow(f-p,2)),0,2*Math.PI,!0);break;case"Pencil":null===(l=y.current)||void 0===l||l.lineTo(f-A(),O-I());break;case"Rectangle":var v=Math.min(f,p)-A(),m=Math.min(O,g)-I(),x=Math.abs(f-p),k=Math.abs(O-g);null===(j=y.current)||void 0===j||j.strokeRect(v,m,x,k)}null===(b=y.current)||void 0===b||b.stroke()}},ref:w}),Object(T.jsx)("canvas",{id:"temp_canvas",ref:E})]})}),B=c.a.memo(U),G=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n=Object(r.useRef)(null),c=Object(r.useRef)(null),a=Object(r.useState)(W[0]),i=Object(j.a)(a,2),u=i[0],s=i[1],d=Object(r.useState)(5),h=Object(j.a)(d,2),f=h[0],p=h[1],O=Object(r.useState)("#776e6e"),g=Object(j.a)(O,2),w=g[0],k=g[1],R=Object(o.c)((function(e){return e.user.user})),A=Object(o.b)();return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("div",{id:"tools",children:[Object(T.jsx)(L.a,{onClick:function(){var n,r;null===(n=c.current)||void 0===n||n.clearRect(0,0,e.current?e.current.width:0,e.current?e.current.height:0),null===(r=t.current)||void 0===r||r.clearRect(0,0,e.current?e.current.width:0,e.current?e.current.height:0)},children:"clear"}),Object(T.jsx)(L.a,{onClick:function(){var e,t,r,c;n.current?(A((e=n.current.toDataURL(),t=R.uid,r=R.displayName,c=R.photoURL,function(){var n=Object(m.a)(v.a.mark((function n(a){var i,o;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=x.collection("images"),o={base64:e,id:"".concat((new Date).getTime()),uid:t,username:r,avatar:c},n.prev=2,n.next=5,i.add(o).then((function(){a({type:E,payload:Object(l.a)({},o)})})).catch((function(e){throw e}));case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),n.t0 instanceof Error?y({message:n.t0.name,description:n.t0.message}):y({message:"error",description:"unknown error"});case 10:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e){return n.apply(this,arguments)}}())),A(C())):y({message:"Something go wrong",description:"Cannot get canvas"})},children:"save"}),Object(T.jsx)(b.a,{value:u,onChange:function(e){s("".concat(e))},children:W.map((function(e,t){return Object(T.jsx)(b.a.Option,{value:e,children:e},"".concat(t))}))}),Object(T.jsx)("input",{type:"color",id:"color",value:w,onChange:function(e){k(e.target.value)}}),Object(T.jsx)(P.a,{value:f,onChange:function(e){p(+e)}})]}),Object(T.jsx)(B,{canvasRef:e,contextRef:t,secondCanvasRef:n,secondContextRef:c,selectedTool:u,lineWidth:f,color:w})]})},F=c.a.memo(G),H=n(238),J=n(112),q=function(){var e=Object(s.g)().path,t=Object(o.b)(),n=Object(r.useState)("feed"),c=Object(j.a)(n,2),a=c[0],i=c[1];return Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(H.a,{mode:"horizontal",id:"page-header",selectedKeys:[a],onClick:function(e){return i(e.key)},children:[Object(T.jsx)(H.a.Item,{children:Object(T.jsx)(u.b,{to:"".concat(e,"/paint"),children:"Paint"})},"paint"),Object(T.jsx)(H.a.Item,{children:Object(T.jsx)(u.b,{to:e,children:"Feed"})},"feed"),Object(T.jsx)(H.a.Item,{children:Object(T.jsx)(L.a,{id:"logout-button",onClick:function(){t(function(){var e=Object(m.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.a.auth().signOut().then((function(){t({type:I,payload:{}})})).catch((function(e){throw e}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),e.t0 instanceof Error?y({message:e.t0.name,description:e.t0.message}):y({message:"error",description:"unknown error"});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()),t({type:S,payload:[]})},children:"Logout"})},"logout-button")]})})},z=c.a.memo(q),X=function(){var e=Object(s.g)().path;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(z,{}),Object(T.jsx)(s.b,{exact:!0,path:e,component:N}),Object(T.jsx)(s.b,{path:"".concat(e,"/paint"),component:F})]})},K=c.a.memo(X),Q=(n(231),function(){var e=Object(o.b)();return Object(T.jsx)("div",{className:"auth-wrapper",children:Object(T.jsxs)("div",{className:"auth-container",children:[Object(T.jsx)("h1",{children:"Sign In with Google"}),Object(T.jsx)(L.a,{onClick:function(){e(function(){var e=Object(m.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new J.a.auth.GoogleAuthProvider,e.prev=1,e.next=4,J.a.auth().signInWithPopup(n).then((function(e){var n=e.user;t({type:A,payload:n||{}})})).catch((function(e){throw e}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),e.t0 instanceof Error?y({message:e.t0.name,description:e.t0.message}):y({message:"error",description:"unknown error"});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}())},children:"Auth"})]})})}),V=c.a.memo(Q),Y="/app",Z="/auth",$="/",ee=function(){var e=Object(o.c)((function(e){return e.user.user.uid}));return Object(T.jsx)(u.a,{children:Object(T.jsxs)(s.d,{children:[Object(T.jsx)(s.b,{exact:!0,path:$,children:Object(T.jsx)(s.a,{to:e?Y:Z})}),Object(T.jsx)(s.b,{path:Y,render:function(){return e?Object(T.jsx)(K,{}):Object(T.jsx)(s.a,{to:Z})}}),Object(T.jsx)(s.b,{path:Z,render:function(){return e?Object(T.jsx)(s.a,{to:Y}):Object(T.jsx)(V,{})}})]})})},te=c.a.memo(ee);var ne,re=(ne=function(e){var t=e.isUsingHOC,n=window.outerWidth>1024?"Desktop":window.outerWidth<=1024&&window.outerWidth>=768?"Tablet":"Mobile";return Object(r.useEffect)((function(){return console.log(n,t)})),Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(te,{})})},function(e){return Object(T.jsx)(ne,Object(l.a)(Object(l.a)({},e),{},{isUsingHOC:!0}))}),ce=n(82),ae={images:[]},ie={user:{}},oe=Object(ce.b)({images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return{images:t.payload};case E:return Object(l.a)({},e);case R:return Object(l.a)(Object(l.a)({},e),{},{images:[].concat(Object(d.a)(e.images.slice(0,e.images.findIndex((function(e){return e.id===t.payload[0].id})))),Object(d.a)(e.images.slice(e.images.findIndex((function(e){return e.id===t.payload[0].id}))+1)))});case S:return{images:t.payload};default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case I:return{user:t.payload};default:return e}}}),ue=n(141),se=function(){try{var e=localStorage.getItem("state");return null===e?{user:{user:{}}}:JSON.parse(e)}catch(t){return{}}}(),le=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ce.c,de=Object(ce.d)(oe,se,le(Object(ce.a)(ue.a,(function(){return function(e){return function(t){console.log("Middleware triggered:",t.type),e(t)}}}))));de.subscribe((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){n instanceof Error?y({message:n.name,description:n.message}):y({message:"error",description:"unknown error"})}}({user:de.getState().user})}));var je=Object(T.jsx)(o.a,{store:de,children:Object(T.jsx)(re,{})});i.a.render(je,document.getElementById("root"))}},[[232,1,2]]]);
//# sourceMappingURL=main.23fd8b95.chunk.js.map